<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Version Logging Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
        }
        #output {
            background: #f5f5f5;
            padding: 10px;
            margin-top: 10px;
            border-radius: 3px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .instruction {
            background: #e3f2fd;
            padding: 10px;
            margin: 10px 0;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>wirejs-dom Version Logging Test</h1>
    
    <div class="instruction">
        <strong>Instructions:</strong>
        <ol>
            <li>Open the browser console to see version logs</li>
            <li>Click "Create HTML Element" multiple times - version should only log once</li>
            <li>Reload the page to test a new session - version should log again</li>
            <li>Check the output area below for element creation confirmation</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>Test: Create HTML Elements</h2>
        <p>Each click creates a new HTML element using the <code>html</code> template tag.</p>
        <p>The version should be logged to console only on the first click per session.</p>
        <button id="createBtn">Create HTML Element</button>
        <button id="clearBtn">Clear Output</button>
        <button id="clearStorageBtn">Clear SessionStorage</button>
        <div id="output"></div>
    </div>

    <div id="container"></div>

    <script type="module">
        import { html, text } from '../lib/v2/index.js';

        let elementCount = 0;
        const output = document.getElementById('output');
        const container = document.getElementById('container');

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            output.textContent += `[${timestamp}] ${message}\n`;
        }

        document.getElementById('createBtn').addEventListener('click', () => {
            elementCount++;
            
            // Create an element using the html template tag
            const element = html`<div class="test-element">
                <h3>Test Element #${text('number', elementCount)}</h3>
                <p>Created at ${new Date().toLocaleTimeString()}</p>
            </div>`;
            
            // Add some styling
            element.style.padding = '10px';
            element.style.margin = '10px 0';
            element.style.background = '#f0f0f0';
            element.style.borderLeft = '3px solid #4CAF50';
            
            container.appendChild(element);
            log(`Created element #${elementCount}`);
            log(`Check console for version log (should only appear once per session)`);
        });

        document.getElementById('clearBtn').addEventListener('click', () => {
            output.textContent = '';
            container.innerHTML = '';
            log('Output cleared (sessionStorage preserved)');
        });

        document.getElementById('clearStorageBtn').addEventListener('click', () => {
            sessionStorage.clear();
            output.textContent = '';
            container.innerHTML = '';
            log('SessionStorage cleared - next element creation will log version again');
        });

        log('Page loaded. Click "Create HTML Element" to test version logging.');
        log('Open browser console to see the version log.');
    </script>
</body>
</html>
